import{u as j,a as A,bG as b,l as M,r as f,bH as E,j as e,p as y,bI as r,T as v,I as p,w as U,_ as I,bJ as w}from"./index-DRKdyhzb.js";import{E as R}from"./Empty-BkwmF9Ca.js";import{M as S}from"./MobileHeader-DhNMB_G6.js";const C=({inbox:t})=>{var m;const l=j(),c=A(),s=b(),o=M(),[i,h]=f.useState(void 0);f.useEffect(()=>{t.activityId&&(async()=>{var d,u,x,N;const{activity:a}=await E.getActivity({id:t.activityId});if(a&&(u=(d=a.payload)==null?void 0:d.memoComment)!=null&&u.relatedMemoId){const k=await o.getOrFetchMemoById((N=(x=a.payload)==null?void 0:x.memoComment)==null?void 0:N.relatedMemoId,{skipStore:!0});h(k)}})()},[t.activityId]);const g=async()=>{i&&(c(`/m/${i.name}`),t.status===r.UNREAD&&n(!0))},n=async(a=!1)=>{await s.updateInbox({name:t.name,status:r.ARCHIVED},["status"]),a||I.success("Archived")};return e.jsxs("div",{className:"w-full flex flex-row justify-start items-start gap-3",children:[e.jsx("div",{className:y("shrink-0 mt-2 p-2 rounded-full border",t.status===r.UNREAD?"border-blue-600 text-blue-600 bg-blue-50 dark:bg-zinc-800":"border-gray-500 text-gray-500 bg-gray-50 dark:bg-zinc-800"),children:e.jsx(v,{title:"Comment",placement:"bottom",children:e.jsx(p.MessageCircle,{className:"w-4 sm:w-5 h-auto"})})}),e.jsxs("div",{className:y("border w-full p-3 px-4 rounded-lg flex flex-col justify-start items-start gap-2 dark:border-zinc-700 hover:bg-gray-100 dark:hover:bg-zinc-700",t.status!==r.UNREAD&&"opacity-60"),children:[e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:(m=t.createTime)==null?void 0:m.toLocaleString()}),e.jsx("div",{children:t.status===r.UNREAD&&e.jsx(v,{title:l("common.archive"),placement:"top",children:e.jsx(p.Inbox,{className:"w-4 h-auto cursor-pointer text-gray-400 hover:text-blue-600",onClick:()=>n()})})})]}),e.jsx("p",{className:"text-base leading-tight cursor-pointer text-gray-500 dark:text-gray-400 hover:underline hover:text-blue-600",onClick:g,children:l("inbox.memo-comment",{user:U(t.sender),memo:`memos#${i==null?void 0:i.name}`})})]})]})},T=({inbox:t})=>{var g,n,m;const l=j(),c=b(),[s,o]=f.useState(void 0);f.useEffect(()=>{t.activityId&&(async()=>{const{activity:a}=await E.getActivity({id:t.activityId});a&&o(a)})()},[t.activityId]);const i=()=>{var a,d,u,x;(d=(a=s==null?void 0:s.payload)==null?void 0:a.versionUpdate)!=null&&d.version&&(window.open(`https://github.com/usememos/memos/releases/tag/v${(x=(u=s==null?void 0:s.payload)==null?void 0:u.versionUpdate)==null?void 0:x.version}`),t.status===r.UNREAD&&h(!0))},h=async(a=!1)=>{await c.updateInbox({name:t.name,status:r.ARCHIVED},["status"]),a||I.success("Archived")};return e.jsxs("div",{className:"w-full flex flex-row justify-start items-start gap-3",children:[e.jsx("div",{className:y("shrink-0 mt-2 p-2 rounded-full border",t.status===r.UNREAD?"border-blue-600 text-blue-600 bg-blue-50 dark:bg-zinc-800":"border-gray-500 text-gray-500 bg-gray-50 dark:bg-zinc-800"),children:e.jsx(v,{title:"Update",placement:"bottom",children:e.jsx(p.ArrowUp,{className:"w-4 sm:w-5 h-auto"})})}),e.jsxs("div",{className:y("border w-full p-3 px-4 rounded-lg flex flex-col justify-start items-start gap-2 dark:border-zinc-700 hover:bg-gray-100 dark:hover:bg-zinc-700",t.status!==r.UNREAD&&"opacity-60"),children:[e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:(g=t.createTime)==null?void 0:g.toLocaleString()}),e.jsx("div",{children:t.status===r.UNREAD&&e.jsx(v,{title:l("common.archive"),placement:"top",children:e.jsx(p.Inbox,{className:"w-4 h-auto cursor-pointer text-gray-400 hover:text-blue-600",onClick:()=>h()})})})]}),e.jsx("p",{className:"text-base leading-tight cursor-pointer text-gray-500 dark:text-gray-400 hover:underline hover:text-blue-600",onClick:i,children:l("inbox.version-update",{version:(m=(n=s==null?void 0:s.payload)==null?void 0:n.versionUpdate)==null?void 0:m.version})})]})]})},$=()=>{const t=j(),l=b(),c=l.inboxes.sort((s,o)=>s.status===o.status?0:s.status===r.UNREAD?-1:1);return f.useEffect(()=>{l.fetchInboxes()},[]),e.jsxs("section",{className:"@container w-full max-w-5xl min-h-full flex flex-col justify-start items-center sm:pt-3 md:pt-6 pb-8",children:[e.jsx(S,{}),e.jsx("div",{className:"w-full px-4 sm:px-6",children:e.jsxs("div",{className:"w-full shadow flex flex-col justify-start items-start px-4 py-3 rounded-xl bg-white dark:bg-zinc-800 text-black dark:text-gray-300",children:[e.jsx("div",{className:"relative w-full flex flex-row justify-between items-center",children:e.jsxs("p",{className:"py-1 flex flex-row justify-start items-center select-none opacity-80",children:[e.jsx(p.Bell,{className:"w-6 h-auto mr-1 opacity-80"}),e.jsx("span",{className:"text-lg",children:t("common.inbox")})]})}),e.jsxs("div",{className:"w-full h-auto flex flex-col justify-start items-start px-2 pb-4",children:[c.length===0&&e.jsxs("div",{className:"w-full mt-4 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx(R,{}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:t("message.no-data")})]}),e.jsx("div",{className:"flex flex-col justify-start items-start w-full mt-4 gap-4",children:c.map(s=>{if(s.type===w.TYPE_MEMO_COMMENT)return e.jsx(C,{inbox:s},`${s.name}-${s.status}`);if(s.type===w.TYPE_VERSION_UPDATE)return e.jsx(T,{inbox:s},`${s.name}-${s.status}`)})})]})]})})]})};export{$ as default};
