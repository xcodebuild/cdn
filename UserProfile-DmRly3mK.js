import{u as S,v as M,d as U,r as a,l as b,m as E,n as T,j as e,B as h,I as m,U as k}from"./index-DRKdyhzb.js";import{E as R}from"./Empty-BkwmF9Ca.js";import{u as _,M as L}from"./useFilterWithUrlParams-BmmRipFM.js";import{M as P}from"./MemoView-Cm1UAYRp.js";import{M as D}from"./MobileHeader-DhNMB_G6.js";import{D as F}from"./CommonDialog-aMGtbYQ-.js";import{g as j}from"./index-2UGuc62r.js";import{u as I}from"./useLoading-Dble4Yjd.js";import"./VisibilityIcon-ijzoLo4J.js";import"./Typography-B6lazjNl.js";import"./index-BG_UZG-p.js";import"./Select-2jlx2KYh.js";import"./createSvgIcon-DiGfNeH6.js";import"./Checkbox-BFDDHFvA.js";import"./Link-bshFRLSU.js";import"./ResourceIcon-CVNzAEyj.js";import"./Divider-ByJybYhk.js";import"./last-DXTTfs9a.js";const te=()=>{const i=S(),c=M(),y=U(),u=I(),[t,g]=a.useState(),w=b(),f=E(),[N,x]=a.useState(!0),n=a.useRef(void 0),{tag:o,text:l}=_(),d=f.value.sort((s,r)=>j(r.displayTime)-j(s.displayTime)).sort((s,r)=>Number(r.pinned)-Number(s.pinned));a.useEffect(()=>{const s=c.username;if(!s)throw new Error("username is required");y.getOrFetchUserByUsername(s).then(r=>{g(r),u.setFinish()}).catch(r=>{console.error(r),T.error(i("message.user-not-found"))})},[c.username]),a.useEffect(()=>{t&&(n.current=void 0,f.reset(),p())},[t,o,l]);const p=async()=>{if(!t)return;const s=[`creator == "${t.name}"`,'row_status == "NORMAL"',"order_by_pinned == true"],r=[];o&&r.push(JSON.stringify(`#${o}`)),l&&r.push(JSON.stringify(l)),r.length>0&&s.push(`content_search == [${r.join(", ")}]`),x(!0);const v=await w.fetchMemos({pageSize:F,filter:s.join(" && "),pageToken:n.current});x(!1),n.current=v.nextPageToken};return e.jsxs("section",{className:"w-full max-w-5xl min-h-full flex flex-col justify-start items-center sm:pt-3 md:pt-6 pb-8",children:[e.jsx(D,{}),e.jsx("div",{className:"w-full px-4 sm:px-6 flex flex-col justify-start items-center",children:!u.isLoading&&(t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative -mt-6 top-8 w-full flex justify-end items-center",children:e.jsx("a",{className:"",href:`/u/${encodeURIComponent(t==null?void 0:t.username)}/rss.xml`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(h,{color:"neutral",variant:"outlined",endDecorator:e.jsx(m.Rss,{className:"w-4 h-auto opacity-60"}),children:"RSS"})})}),e.jsxs("div",{className:"w-full flex flex-col justify-start items-center py-8",children:[e.jsx(k,{className:"!w-20 !h-20 mb-2 drop-shadow",avatarUrl:t==null?void 0:t.avatarUrl}),e.jsx("div",{className:"w-full flex flex-row justify-center items-center",children:e.jsx("p",{className:"text-3xl text-black leading-none opacity-80 dark:text-gray-200",children:t==null?void 0:t.nickname})})]}),e.jsx(L,{className:"px-2 pb-3"}),d.map(s=>e.jsx(P,{memo:s,showVisibility:!0,showPinned:!0},`${s.id}-${s.displayTime}`)),N?e.jsxs("div",{className:"flex flex-row justify-center items-center w-full my-4 text-gray-400",children:[e.jsx(m.Loader,{className:"w-4 h-auto animate-spin mr-1"}),e.jsx("p",{className:"text-sm italic",children:i("memo.fetching-data")})]}):n.current?e.jsx("div",{className:"w-full flex flex-row justify-center items-center my-4",children:e.jsx(h,{variant:"plain",endDecorator:e.jsx(m.ArrowDown,{className:"w-5 h-auto"}),onClick:p,children:i("memo.fetch-more")})}):d.length===0&&e.jsxs("div",{className:"w-full mt-12 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx(R,{}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:i("message.no-data")})]})]}):e.jsx("p",{children:"Not found"}))})]})};export{te as default};
