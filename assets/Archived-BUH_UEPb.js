import{u as M,k as S,l as T,m as k,r as c,R as u,j as e,T as p,I as i,B as b,_ as h}from"./index-DRgDHYoO.js";import{D as C,s as E}from"./CommonDialog-CH82Q2vd.js";import{E as R}from"./Empty-DAchDJLP.js";import{g as j,a as D,M as I}from"./index-BFGkap1V.js";import{u as _,M as A}from"./useFilterWithUrlParams-C4vxzj15.js";import{M as L}from"./MobileHeader-DLc6LEza.js";import{S as $}from"./SearchBar-jg8Goukd.js";import"./last-DXTTfs9a.js";import"./index-B_9e4a9Y.js";import"./ResourceIcon-D5Y2tg6_.js";import"./useLoading-Bp4Y2TVR.js";import"./Divider-Nkit0Pid.js";import"./Checkbox-cv5AtFNC.js";import"./createSvgIcon-Bmjcqfz4.js";import"./Typography-BSwVQflm.js";const X=()=>{const a=M(),y=S(),l=T(),m=k(),[w,d]=c.useState(!0),r=c.useRef(void 0),{tag:o,text:n}=_(),x=m.value.filter(t=>t.rowStatus===u.ARCHIVED).sort((t,s)=>j(s.displayTime)-j(t.displayTime));c.useEffect(()=>{r.current=void 0,m.reset(),f()},[o,n]);const f=async()=>{const t=[`creator == "${y.name}"`,'row_status == "ARCHIVED"'],s=[];o&&s.push(JSON.stringify(`#${o}`)),n&&s.push(JSON.stringify(n)),s.length>0&&t.push(`content_search == [${s.join(", ")}]`),d(!0);const v=await l.fetchMemos({pageSize:C,filter:t.join(" && "),pageToken:r.current});d(!1),r.current=v.nextPageToken},g=async t=>{E({title:a("memo.delete-memo"),content:a("memo.delete-confirm"),style:"danger",dialogName:"delete-memo-dialog",onConfirm:async()=>{await l.deleteMemo(t.id)}})},N=async t=>{try{await l.updateMemo({id:t.id,rowStatus:u.ACTIVE},["row_status"]),h(a("message.restored-successfully"))}catch(s){console.error(s),h.error(s.details)}};return e.jsxs("section",{className:"@container w-full max-w-5xl min-h-full flex flex-col justify-start items-center sm:pt-3 md:pt-6 pb-8",children:[e.jsx(L,{}),e.jsx("div",{className:"w-full px-4 sm:px-6",children:e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("div",{className:"w-full flex flex-row justify-end items-center mb-2",children:e.jsx("div",{className:"w-40",children:e.jsx($,{})})}),e.jsx(A,{className:"px-2 pb-2"}),x.map(t=>e.jsxs("div",{className:"relative flex flex-col justify-start items-start w-full p-4 pt-3 mb-2 bg-white dark:bg-zinc-800 rounded-lg",children:[e.jsxs("div",{className:"w-full mb-1 flex flex-row justify-between items-center",children:[e.jsx("div",{className:"w-full max-w-[calc(100%-20px)] flex flex-row justify-start items-center mr-1",children:e.jsx("span",{className:"text-sm text-gray-400 select-none",children:D(t.displayTime)})}),e.jsxs("div",{className:"flex flex-row justify-end items-center gap-x-2",children:[e.jsx(p,{title:a("common.restore"),placement:"top",children:e.jsx("button",{onClick:()=>N(t),children:e.jsx(i.ArchiveRestore,{className:"w-4 h-auto cursor-pointer text-gray-500 dark:text-gray-400"})})}),e.jsx(p,{title:a("common.delete"),placement:"top",children:e.jsx("button",{onClick:()=>g(t),className:"text-gray-500 dark:text-gray-400",children:e.jsx(i.Trash,{className:"w-4 h-auto cursor-pointer"})})})]})]}),e.jsx(I,{memoId:t.id,content:t.content,readonly:!0},`${t.id}-${t.displayTime}`)]},t.id)),w?e.jsxs("div",{className:"flex flex-row justify-center items-center w-full my-4 text-gray-400",children:[e.jsx(i.Loader,{className:"w-4 h-auto animate-spin mr-1"}),e.jsx("p",{className:"text-sm italic",children:a("memo.fetching-data")})]}):r.current?e.jsx("div",{className:"w-full flex flex-row justify-center items-center my-4",children:e.jsx(b,{variant:"plain",endDecorator:e.jsx(i.ArrowDown,{className:"w-5 h-auto"}),onClick:f,children:a("memo.fetch-more")})}):x.length===0&&e.jsxs("div",{className:"w-full mt-16 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx(R,{}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:a("message.no-data")})]})]})})]})};export{X as default};
