import{bz as A,b4 as w,r as h,j as i,I as c,bu as W,p}from"./index-DRgDHYoO.js";import{g as X}from"./CommonDialog-CH82Q2vd.js";var z=/\s/;function _(e){for(var t=e.length;t--&&z.test(e.charAt(t)););return t}var $=/^\s+/;function L(e){return e&&e.slice(0,_(e)+1).replace($,"")}var I=NaN,B=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,F=/^0o[0-7]+$/i,M=parseInt;function P(e){if(typeof e=="number")return e;if(A(e))return I;if(w(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=w(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=L(e);var r=D.test(e);return r||F.test(e)?M(e.slice(2),r?2:8):B.test(e)?I:+e}var N=1/0,Y=17976931348623157e292;function O(e){if(!e)return e===0?e:0;if(e=P(e),e===N||e===-N){var t=e<0?-1:1;return t*Y}return e===e?e:0}function ae(e){var t=O(e),r=t%1;return t===t?r?t-r:t:0}var q={BASE_URL:"https://cdn.jsdelivr.net/gh/xcodebuild/cdn@master/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const U=e=>e.externalLink?e.externalLink:`${q.VITE_API_BASE_URL||window.location.origin}/o/r/${e.name}`,V=e=>H(e.type)?"image/*":e.type.startsWith("video")?"video/*":e.type.startsWith("audio")?"audio/*":e.type.startsWith("text")?"text/*":e.type.startsWith("application/epub+zip")?"application/epub+zip":e.type.startsWith("application/pdf")?"application/pdf":e.type.includes("word")?"application/msword":e.type.includes("excel")?"application/msexcel":e.type.startsWith("application/zip")?"application/zip":e.type.startsWith("application/x-java-archive")?"application/x-java-archive":"application/octet-stream",H=e=>e.startsWith("image/")&&!G(e),G=e=>e==="image/vnd.adobe.photoshop"||e==="image/x-photoshop"||e==="image/photoshop",J=.5,K=5,Q=.25,m={scale:1,originX:-1,originY:-1},Z=({destroy:e,imgUrls:t,initialIndex:r})=>{const[a,o]=h.useState(r),[n,l]=h.useState(m);let u=-1,d=-1;const j=()=>{e()},y=s=>{s.touches.length>1||(u=s.touches[0].clientX)},S=s=>{s.touches.length>1||(d=s.touches[0].clientX)},b=s=>{if(!(s.touches.length>1)){if(u>-1&&d>-1){const f=u-d;f>50?x():f<-50&&g()}d=-1,u=-1}},g=()=>{a>0?(l(m),o(a-1)):e()},x=()=>{a<t.length-1?(l(m),o(a+1)):e()},E=s=>{s.clientX<window.innerWidth/2?g():x()},v=s=>{const f=s.nativeEvent.offsetX,C=s.nativeEvent.offsetY,R=s.deltaY<0?1:-1,T=Math.max(J,Math.min(K,n.scale+R*Q));l({...n,originX:f,originY:C,scale:T})},k={transform:`scale(${n.scale})`,transformOrigin:`${n.originX===-1?"center":`${n.originX}px`} ${n.originY===-1?"center":`${n.originY}px`}`};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"btns-container",children:i.jsx("button",{className:"btn",onClick:j,children:i.jsx(c.X,{className:"icon-img"})})}),i.jsx("div",{className:"img-container",onClick:E,children:i.jsx("img",{style:k,src:t[a],onClick:s=>s.stopPropagation(),onTouchStart:y,onTouchMove:S,onTouchEnd:b,onWheel:v,decoding:"async",loading:"lazy"})})]})};function ee(e,t){X({className:"preview-image-dialog",dialogName:"preview-image-dialog"},Z,{imgUrls:Array.isArray(e)?e:[e],initialIndex:t||0})}const te=e=>{const{children:t,className:r}=e,a=e.baseSide||"width",o=h.useRef(null);return h.useEffect(()=>{const n=()=>{if(o.current)if(a==="width"){const l=o.current.clientWidth;o.current.style.height=l+"px"}else{const l=o.current.clientHeight;o.current.style.width=l+"px"}};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),i.jsx("div",{ref:o,className:`${[a==="width"?"w-full":"h-full",r??""].join(" ")}`,children:t})},ne=e=>{const{resource:t}=e,r=V(t),a=U(t),o=p("w-full h-auto",e.className),n=e.strokeWidth,l=()=>{window.open(a)};if(r==="image/*")return i.jsx(te,{className:p(o,"flex items-center justify-center overflow-clip"),children:i.jsx("img",{className:"min-w-full min-h-full object-cover border rounded dark:border-none",src:t.externalLink?a:a+"?thumbnail=1",onClick:()=>ee(a),decoding:"async",loading:"lazy"})});const u=()=>{switch(r){case"video/*":return i.jsx(c.FileVideo2,{strokeWidth:n,className:"w-full h-auto"});case"audio/*":return i.jsx(c.FileAudio,{strokeWidth:n,className:"w-full h-auto"});case"text/*":return i.jsx(c.FileText,{strokeWidth:n,className:"w-full h-auto"});case"application/epub+zip":return i.jsx(c.Book,{strokeWidth:n,className:"w-full h-auto"});case"application/pdf":return i.jsx(c.Book,{strokeWidth:n,className:"w-full h-auto"});case"application/msword":return i.jsx(c.FileEdit,{strokeWidth:n,className:"w-full h-auto"});case"application/msexcel":return i.jsx(c.SheetIcon,{strokeWidth:n,className:"w-full h-auto"});case"application/zip":return i.jsx(c.FileArchiveIcon,{onClick:l,strokeWidth:n,className:"w-full h-auto"});case"application/x-java-archive":return i.jsx(c.BinaryIcon,{strokeWidth:n,className:"w-full h-auto"});default:return i.jsx(c.File,{strokeWidth:n,className:"w-full h-auto"})}};return i.jsx("div",{onClick:l,className:p(o,"max-w-[4rem] opacity-50"),children:u()})},re=W.memo(ne);export{re as R,te as S,V as a,O as b,U as g,ee as s,ae as t};
